{{ define "content" }}
{{- /* Generate version identifier from content hash */ -}}
{{- $contentHash := sha256 .RawContent -}}
{{- $shortHash := substr $contentHash 0 4 -}}
{{- $currentYear := now.Format "06" -}}
{{- $versionId := printf "%s: v%s.%s" (i18n "version") $currentYear $shortHash -}}

<article class="resume-page">
  {{- /* Resume controls (home button + paper size toggle, screen only) */ -}}
  <div class="resume-controls screen-only">
    {{- /* Home button */ -}}
    <a href="/" class="home-button" title="Return to home">
      {{- partial "svg.html" "icons/fontawesome/house" -}}
    </a>

    {{- /* Paper size toggle and action buttons */ -}}
    <div class="paper-size-toggle-container">
      <div class="flex items-center gap-2 mb-2">
        <label for="paper-size-select" class="text-slate-700">
          {{- partial "svg.html" "icons/fontawesome/file-lines" -}}
        </label>
        <select id="paper-size-select" class="px-3 py-1 text-sm border border-slate-300 rounded bg-white text-slate-900">
          <option value="letter">{{ i18n "letter" | default "Letter" }} (8.5" × 11")</option>
          <option value="a4">{{ i18n "a4" | default "A4" }} (210mm × 297mm)</option>
        </select>
      </div>
      <button data-action="print" role="button" class="print-button flex items-center justify-center gap-2 w-full px-3 py-2 text-sm font-medium rounded bg-slate-700 text-white hover:bg-slate-800 transition-colors cursor-pointer">
        {{- partial "svg.html" "icons/fontawesome/print" -}}
        <span>Print</span>
      </button>
      <a href="/resume-letter.pdf"
         download="tom-barrasso-resume-letter-{{ .Date.Format "2006" }}.pdf"
         data-pdf-letter="/resume-letter.pdf"
         data-pdf-a4="/resume-a4.pdf"
         data-filename-base="tom-barrasso-resume"
         data-filename-year="{{ .Date.Format "2006" }}"
         class="pdf-download-button flex items-center justify-center gap-2 w-full px-3 py-2 text-sm font-medium rounded bg-slate-700 text-white hover:bg-slate-800 transition-colors cursor-pointer no-underline mt-2">
        {{- partial "svg.html" "icons/fontawesome/download" -}}
        <span>{{ i18n "download_pdf" | default "Download PDF" }}</span>
      </a>
    </div>
  </div>

  {{- /* Resume container with paper styling */ -}}
  <div class="resume-container" id="resume-container" data-paper-size="letter">
    <script type="text/javascript">
      let paperSize = localStorage.getItem("resume-paper-size");
      if (paperSize) {
        document.getElementById("resume-container").dataset.paperSize = paperSize;
      }
    </script>
    {{- /* Header Section */ -}}
    <header class="resume-header mb-6">
      <div class="flex items-start justify-between">
        <h1 class="text-4xl font-bold text-slate-900">
          {{ .Params.name | default .Title }}
        </h1>

        <div class="contact-info flex flex-col items-end gap-1 text-sm text-slate-700">
          {{- if .Params.email }}
          <a href="mailto:{{ .Params.email }}" class="inline-flex items-center gap-1 hover:text-slate-900 no-underline">
            {{- partial "svg.html" "icons/fontawesome/envelope" -}}
            {{ .Params.email }}
          </a>
          {{- end }}

          {{- if .Params.phone }}
          <a href="tel:{{ .Params.phone }}" class="inline-flex items-center gap-1 hover:text-slate-900 no-underline">
            {{- partial "svg.html" "icons/fontawesome/phone" -}}
            {{ .Params.phone }}
          </a>
          {{- end }}

          {{- if .Params.location }}
          <span class="inline-flex items-center gap-1">
            {{- partial "svg.html" "icons/fontawesome/location-dot" -}}
            {{ .Params.location }}
          </span>
          {{- end }}
        </div>
      </div>

      {{- if .Params.summary }}
      <p class="text-sm text-slate-700 leading-relaxed">
        {{ .Params.summary }}
      </p>
      {{- end }}
    </header>

    {{- /* Two-column layout */ -}}
    <div class="resume-content-grid">
      {{- /* Main Content (left column, 66%) */ -}}
      <main class="resume-main-content">
        {{ .Content }}
      </main>

      {{- /* Sidebar (right column, 33%) */ -}}
      <aside class="resume-sidebar">
        {{- /* Check for shortcode-based sidebar content first */ -}}
        {{- $sidebarContent := .Scratch.Get "sidebar-content" -}}

        {{- if $sidebarContent }}
          {{- /* Render sidebar sections from shortcodes */ -}}
          {{ $sidebarContent | safeHTML }}
        {{- else }}
          {{- /* Fallback: Render from frontmatter (backwards compatibility) */ -}}

          {{- /* Skills Section */ -}}
          {{- if and .Params.showSkills .Params.skills }}
          <section class="sidebar-section mb-4">
            <h2 class="text-lg font-semibold mb-2 pb-1 border-b border-slate-300">
              {{ i18n "skills" | default "Skills" }}
            </h2>
            <ul class="space-y-0.5 text-xs text-slate-700 list-none">
              {{- range .Params.skills }}
              <li>{{ . }}</li>
              {{- end }}
            </ul>
          </section>
          {{- end }}

          {{- /* Technologies Section */ -}}
          {{- if and .Params.showTechnologies .Params.technologies }}
          <section class="sidebar-section mb-8">
            <h2 class="text-base font-semibold mb-2 pb-1 border-b border-slate-300">
              {{ i18n "technologies" | default "Technologies" }}
            </h2>
            <ul class="space-y-0.5 text-xs text-slate-700 list-none">
              {{- range .Params.technologies }}
              <li>{{ . }}</li>
              {{- end }}
            </ul>
          </section>
          {{- end }}
        {{- end }}

        {{- /* Links Section */ -}}
        {{- if .Params.showLinks }}
        <section class="sidebar-section mb-8">
          <h2 class="text-base font-semibold mb-2 pb-1 border-b border-slate-300">
            {{ i18n "links" | default "Links" }}
          </h2>
          <div class="space-y-1 text-xs">
            {{- with .Params.links }}
              {{- if .github }}
              <a href="{{ .github }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-slate-700 hover:text-slate-900 no-underline">
                {{- partial "svg.html" "icons/fontawesome/github" -}}
                <span>GitHub</span>
              </a>
              {{- end }}

              {{- if .linkedin }}
              <a href="{{ .linkedin }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-slate-700 hover:text-slate-900 no-underline">
                {{- partial "svg.html" "icons/fontawesome/linkedin" -}}
                <span>LinkedIn</span>
              </a>
              {{- end }}

              {{- if .portfolio }}
              <a href="{{ .portfolio }}" target="_blank" rel="noopener noreferrer" class="flex items-center gap-2 text-slate-700 hover:text-slate-900 no-underline">
                {{- partial "svg.html" "icons/fontawesome/globe" -}}
                <span>Portfolio</span>
              </a>
              {{- end }}
            {{- end }}
          </div>
        </section>
        {{- end }}

        {{- /* Spacer to push footer to bottom */ -}}
        <div class="sidebar-spacer"></div>

        {{- /* Footer with typeset note */ -}}
        <footer class="sidebar-footer pt-4 border-t border-slate-300">
          <p class="text-xs text-slate-500 leading-relaxed">
            {{ i18n "resume_typeset"}}<br />
            {{- with .Params.links -}}
            <a href="https://{{ .resumeGitLink | default "git.io/resume" }}" target="_blank" rel="noopener noreferrer" class="text-slate-600 hover:text-slate-900 resume-typeset-link https-before">
              {{ .resumeGitLink | default "git.io/resume" }}
            </a>
            {{- end -}}
          </p>
        </footer>
      </aside>
    </div>

    {{- /* Footer with version identifier */ -}}
    <footer class="resume-version-footer text-xs text-slate-500">
      <span class="resume-version-identifier">
        {{ $versionId }}
      </span>
    </footer>
  </div>
</article>
{{ end }}
